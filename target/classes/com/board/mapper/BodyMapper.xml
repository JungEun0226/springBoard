<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.board.mapper.BodyMapper">
	<select id="getMemberIdCheck" parameterType="String" resultType="int">
		select count(*) from member where memberid=#{id}
	</select>
	
	<select id="getEmailCheck" parameterType="String" resultType="int">
	<![CDATA[
		select count(*) from member where memberemail=#{email}
	]]>
	</select>
	
	<insert id="setSignUp" parameterType="com.board.body.dto.MemberDto">
	<![CDATA[
		INSERT INTO member VALUES(membernumber_seq.nextval, #{memberid}, #{memberpass}, #{memberemail})
	]]>
	</insert>
	
	<select id="login" parameterType="com.board.body.dto.MemberDto" resultType="String">
		select membernumber from member where memberid=#{memberid} and memberpass=#{memberpass}
	</select>
	
	<select id="getCategoryNumber" parameterType="String" resultType="int">
		select categorynumber from category where categoryname=#{categoryname}
	</select>
	
	<insert id="setBoardWrite" parameterType="com.board.body.dto.BoardWriteDto">
	<![CDATA[
		INSERT INTO boardwrite(membernumber, categorynumber, writenumber, title, content, views, writedate, filename, filepath)
		VALUES(#{membernumber}, #{categorynumber}, writenumber_seq.nextval, #{title}, #{content}, 0, #{writedate}, #{filename,jdbcType=VARCHAR}, #{filepath,jdbcType=VARCHAR})
	]]>
	</insert>
	
	<select id="getBoardDetailWriteNumber" parameterType="String" resultType="com.board.body.dto.BoardWriteDto">
		select * from boardwrite where writenumber=#{wn}
	</select>
	
	<update id="updateViews" parameterType="String">
		update boardwrite set views=views+1 where writenumber=#{wn}
	</update>
	
	<update id="updateWrite" parameterType="com.board.body.dto.BoardWriteDto">
		update boardwrite
		set categorynumber=#{categorynumber}, title=#{title}, content=#{content}, writedate=#{writedate}, filename=#{filename,jdbcType=VARCHAR}, filepath=#{filepath,jdbcType=VARCHAR}
		where writenumber=#{writenumber}
	</update>
	
	<delete id="deleteWrite" parameterType="String">
		delete from boardwrite where writenumber=#{writenumber}
	</delete>
	
	<select id="getFilePath" parameterType="String" resultType="String">
		SELECT filepath FROM boardwrite WHERE writenumber=#{writenumber}
	</select>
</mapper>

